import "tfplan/v2" as tfplan

resources = tfplan.resource_changes

invalid = resources.where(
    # Validate only resources that actually have tags
    _.change.after contains "tags" and 
    (
        not ("Environment" in _.change.after.tags) or
        not ("Owner" in _.change.after.tags)
    )
)

main = rule {
    invalid is empty
}

test {
    rules = {
        main = true
    }
}
